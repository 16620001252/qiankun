<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>API | qiankun</title>
    <meta name="generator" content="VuePress 1.4.1">
    <script>
        var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = "https://hm.baidu.com/hm.js?0f738d9b0ac90574c09183ea85bcfa2e";
          var s = document.getElementsByTagName("script")[0];
          s.parentNode.insertBefore(hm, s);
        })();
      </script>
    <meta name="description" content="Probably the most complete micro-frontends solution you ever met🧐">
    <meta name="keywords" content="microfrontend, micro frontend, micro frontends, micro-frontend, micro-frontends, microservice, javascript">
    <link rel="preload" href="/qiankun/assets/css/0.styles.b60dbe72.css" as="style"><link rel="preload" href="/qiankun/assets/js/app.0c03f5c9.js" as="script"><link rel="preload" href="/qiankun/assets/js/2.b25794af.js" as="script"><link rel="preload" href="/qiankun/assets/js/7.55c9405f.js" as="script"><link rel="preload" href="/qiankun/assets/js/3.0164b3a4.js" as="script"><link rel="prefetch" href="/qiankun/assets/js/10.6499211f.js"><link rel="prefetch" href="/qiankun/assets/js/11.1efbb372.js"><link rel="prefetch" href="/qiankun/assets/js/12.834b3b97.js"><link rel="prefetch" href="/qiankun/assets/js/13.881fc36e.js"><link rel="prefetch" href="/qiankun/assets/js/14.f82c43f9.js"><link rel="prefetch" href="/qiankun/assets/js/15.a66b636b.js"><link rel="prefetch" href="/qiankun/assets/js/16.abaaecdb.js"><link rel="prefetch" href="/qiankun/assets/js/17.8b2925ac.js"><link rel="prefetch" href="/qiankun/assets/js/4.3ae9d82a.js"><link rel="prefetch" href="/qiankun/assets/js/5.23910528.js"><link rel="prefetch" href="/qiankun/assets/js/6.4ea80c66.js"><link rel="prefetch" href="/qiankun/assets/js/8.506b9ab1.js"><link rel="prefetch" href="/qiankun/assets/js/9.cb2f04b2.js">
    <link rel="stylesheet" href="/qiankun/assets/css/0.styles.b60dbe72.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/qiankun/" class="home-link router-link-active"><!----> <span class="site-name">qiankun</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/qiankun/guide/" class="nav-link">
  Guide
</a></div><div class="nav-item"><a href="/qiankun/api/" class="nav-link router-link-exact-active router-link-active">
  API
</a></div><div class="nav-item"><a href="/qiankun/faq/" class="nav-link">
  FAQ
</a></div><div class="nav-item"><a href="https://github.com/umijs/qiankun/releases" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Changelog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://v1.qiankun.umijs.org/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  1.x
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/qiankun/api/" class="nav-link router-link-exact-active router-link-active">
  English
</a></li><li class="dropdown-item"><!----> <a href="/qiankun/zh/api/" class="nav-link">
  简体中文
</a></li></ul></div></div> <a href="https://github.com/umijs/qiankun" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/qiankun/guide/" class="nav-link">
  Guide
</a></div><div class="nav-item"><a href="/qiankun/api/" class="nav-link router-link-exact-active router-link-active">
  API
</a></div><div class="nav-item"><a href="/qiankun/faq/" class="nav-link">
  FAQ
</a></div><div class="nav-item"><a href="https://github.com/umijs/qiankun/releases" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Changelog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://v1.qiankun.umijs.org/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  1.x
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/qiankun/api/" class="nav-link router-link-exact-active router-link-active">
  English
</a></li><li class="dropdown-item"><!----> <a href="/qiankun/zh/api/" class="nav-link">
  简体中文
</a></li></ul></div></div> <a href="https://github.com/umijs/qiankun" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/qiankun/api/" class="active sidebar-link">API</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/qiankun/api/#route-based-configuration" class="sidebar-link">Route based configuration</a></li><li class="sidebar-sub-header"><a href="/qiankun/api/#manually-load-micro-applications" class="sidebar-link">Manually load micro applications</a></li><li class="sidebar-sub-header"><a href="/qiankun/api/#adderrorhandler-removeerrorhandler" class="sidebar-link">addErrorHandler/removeErrorHandler</a></li><li class="sidebar-sub-header"><a href="/qiankun/api/#addglobaluncaughterrorhandler-handler" class="sidebar-link">addGlobalUncaughtErrorHandler(handler)</a></li><li class="sidebar-sub-header"><a href="/qiankun/api/#removeglobaluncaughterrorhandler-handler" class="sidebar-link">removeGlobalUncaughtErrorHandler(handler)</a></li><li class="sidebar-sub-header"><a href="/qiankun/api/#initgloabalstate-state" class="sidebar-link">initGloabalState(state)</a></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="api"><a href="#api" class="header-anchor">#</a> API</h1> <h2 id="route-based-configuration"><a href="#route-based-configuration" class="header-anchor">#</a> Route based configuration</h2> <p>Suitable for route-based scenarios.</p> <p>By linking the micro-application to some url rules, the function of automatically loading the corresponding micro-application when the browser url changes.</p> <h3 id="registermicroapps-apps-lifecycles"><a href="#registermicroapps-apps-lifecycles" class="header-anchor">#</a> <code>registerMicroApps(apps, lifeCycles?)</code></h3> <ul><li><p>Parameters</p> <ul><li>apps - <code>Array&lt;RegistrableApp&gt;</code> - required, registration information for the child application</li> <li>lifeCycles - <code>LifeCycles</code> - optional, global sub app lifecycle hooks</li></ul></li> <li><p>Type</p> <ul><li><p><code>RegistrableApp</code></p> <ul><li><p>name - <code>string</code> - required, the name of the child application and must be unique between the child applications.</p></li> <li><p>entry - <code>string | { scripts?: string[]; styles?: string[]; html?: string }</code> - required, The entry url of the child application.</p></li> <li><p>container - <code>string | HTMLElement</code> - required，A selector or Element instance of the container node of a micro application. Such as <code>container: '#root'</code> or <code>container: document.querySelector('#root')</code>.</p></li> <li><p>activeRule -  - <code>string | (location: Location) =&gt; boolean | Array&lt;string | (location: Location) =&gt; boolean&gt;</code> - required,activation rules for micro-apps.</p> <ul><li>Support direct configuration of string or string array, such as <code>activeRule: '/app1'</code> or <code>activeRule: ['/app1', '/app2']</code>, when configured as a string, it will directly follow the path part in the url Do a prefix match. A successful match indicates that the current application will be activated.</li> <li>Support to configure an active function or a group of active functions. The function will pass in the current location as a parameter. When the function returns true, it indicates that the current micro application will be activated. Such as <code>location =&gt; location.pathname.startsWith ('/app1')</code>.</li></ul> <p>Example rules:</p> <p><code>'/app1'</code></p> <ul><li><p>✅ https://app.com/app1</p></li> <li><p>✅ https://app.com/app1/anything/everything</p></li> <li><p>🚫 https://app.com/app2</p></li></ul> <p><code>'/users/:userId/profile'</code></p> <ul><li>✅ https://app.com/users/123/profile</li> <li>✅ https://app.com/users/123/profile/sub-profile/</li> <li>🚫 https://app.com/users//profile/sub-profile/</li> <li>🚫 https://app.com/users/profile/sub-profile/</li></ul> <p><code>'/pathname/#/hash'</code></p> <ul><li>✅ https://app.com/pathname/#/hash</li> <li>✅ https://app.com/pathname/#/hash/route/nested</li> <li>🚫 https://app.com/pathname#/hash/route/nested</li> <li>🚫 https://app.com/pathname#/another-hash</li></ul> <p><code>['/pathname/#/hash', '/app1']</code></p> <ul><li>✅ https://app.com/pathname/#/hash/route/nested</li> <li>✅ https://app.com/app1/anything/everything</li> <li>🚫 https://app.com/pathname/app1</li> <li>🚫 https://app.com/app2</li></ul> <p>This function is called when the browser url changes, and <code>activeRule</code> returns <code>true</code> to indicate that the subapplication needs to be activated.</p></li> <li><p>loader - <code>(loading: boolean) =&gt; void</code> - optional, function will be invoked while the loading state changed.</p></li> <li><p>props - <code>object</code> - optional, data that the primary application needs to pass to the child application.</p></li></ul></li> <li><p><code>LifeCycles</code></p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">type</span> <span class="token function-variable function">Lifecycle</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">app<span class="token operator">:</span> RegistrableApp</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>beforeLoad - <code>Lifecycle | Array&lt;Lifecycle&gt;</code> - optional</li> <li>beforeMount - <code>Lifecycle | Array&lt;Lifecycle&gt;</code> - optional</li> <li>afterMount - <code>Lifecycle | Array&lt;Lifecycle&gt;</code> - optional</li> <li>beforeUnmount - <code>Lifecycle | Array&lt;Lifecycle&gt;</code> - optional</li> <li>afterUnmount - <code>Lifecycle | Array&lt;Lifecycle&gt;</code> - optional</li></ul></li></ul></li> <li><p>Usage</p> <p>Configuration information for registered subapplications in the main application.</p></li> <li><p>Sample</p> <div class="language-tsx extra-class"><pre class="language-tsx"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> registerMicroApps <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'qiankun'</span><span class="token punctuation">;</span>

<span class="token function">registerMicroApps</span><span class="token punctuation">(</span>
  <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      name<span class="token operator">:</span> <span class="token string">'app1'</span><span class="token punctuation">,</span>
      entry<span class="token operator">:</span> <span class="token string">'//localhost:8080'</span><span class="token punctuation">,</span>
      container<span class="token operator">:</span> <span class="token string">'#container'</span><span class="token punctuation">,</span>
      activeRule<span class="token operator">:</span> <span class="token string">'/react'</span><span class="token punctuation">,</span>
      props<span class="token operator">:</span> <span class="token punctuation">{</span>
        name<span class="token operator">:</span> <span class="token string">'kuitos'</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token function-variable function">beforeLoad</span><span class="token operator">:</span> <span class="token parameter">app</span> <span class="token operator">=&gt;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'before load'</span><span class="token punctuation">,</span> app<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span>
    beforeMount<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token parameter">app</span> <span class="token operator">=&gt;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'before mount'</span><span class="token punctuation">,</span> app<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li></ul> <h3 id="start-opts"><a href="#start-opts" class="header-anchor">#</a> <code>start(opts?)</code></h3> <ul><li><p>Parameters</p> <ul><li>opts - <code>Options</code> optional</li></ul></li> <li><p>Type</p> <ul><li><p><code>Options</code></p> <ul><li><p>prefetch - <code>boolean | 'all' | string[] | (( apps: RegistrableApp[] ) =&gt; { criticalAppNames: string[]; minorAppsName: string[] })</code> - optional, whether to enable prefetch, default is <code>true</code>.</p> <p>A configuration of <code>true</code> starts prefetching static resources for other subapplications after the first subapplication mount completes.</p> <p>If configured as <code>'all'</code>, the main application <code>start</code> will begin to preload all subapplication static resources.</p> <p>If configured as <code>string[]</code>, starts prefetching static resources for subapplications after the first subapplication mount completes which be declared in this list.</p> <p>If configured as <code>function</code>, the timing of all subapplication static resources will be controlled by yourself.</p></li> <li><p>sandbox - <code>boolean</code> | <code>{ strictStyleIsolation?: boolean }</code> - optional, whether to open the js sandbox, default is <code>true</code>.</p> <p>When configured as <code>{strictStyleIsolation: true}</code>, qiankun will convert the container dom of each application to a <a href="https://developer.mozilla.org/en-US/docs/Web/Web_Components/Using_shadow_DOM" target="_blank" rel="noopener noreferrer">shadow dom<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, to ensure that the style of the application will not leak to the global.</p></li> <li><p>singular - <code>boolean | ((app: RegistrableApp&lt;any&gt;) =&gt; Promise&lt;boolean&gt;);</code> - optional，whether is a singular mode，default is <code>true</code>.</p></li> <li><p>fetch - <code>Function</code> - optional</p></li> <li><p>getPublicPath - <code>(url: string) =&gt; string</code> - optional</p></li> <li><p>getTemplate - <code>(tpl: string) =&gt; string</code> - optional</p></li></ul></li></ul></li> <li><p>Usage</p> <p>Start qiankun.</p></li> <li><p>Sample</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> start <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'qiankun'</span><span class="token punctuation">;</span>

<span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li></ul> <h3 id="setdefaultmountapp-applink"><a href="#setdefaultmountapp-applink" class="header-anchor">#</a> <code>setDefaultMountApp(appLink)</code></h3> <ul><li><p>Parameters</p> <ul><li>appLink - <code>string</code> - required</li></ul></li> <li><p>Usage</p> <p>Sets the child application that enters by default after the main application starts.</p></li> <li><p>Sample</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> setDefaultMountApp <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'qiankun'</span><span class="token punctuation">;</span>

<span class="token function">setDefaultMountApp</span><span class="token punctuation">(</span><span class="token string">'/homeApp'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li></ul> <h3 id="runafterfirstmounted-effect"><a href="#runafterfirstmounted-effect" class="header-anchor">#</a> <code>runAfterFirstMounted(effect)</code></h3> <ul><li><p>Parameters</p> <ul><li>effect - <code>() =&gt; void</code> - required</li></ul></li> <li><p>Usage</p> <p>Methods that need to be called after the first subapplication mount, such as turning on some monitoring or buried scripts.</p></li> <li><p>Sample</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> runAfterFirstMounted <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'qiankun'</span><span class="token punctuation">;</span>

<span class="token function">runAfterFirstMounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">startMonitor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li></ul> <h2 id="manually-load-micro-applications"><a href="#manually-load-micro-applications" class="header-anchor">#</a> Manually load micro applications</h2> <p>It is suitable for scenarios where a micro application needs to be manually loaded / unloaded.</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>Usually in this scenario, the micro application is a business component that can run independently without routing.
Micro applications should not be split too fine, it is recommended to split according to the business domain. Functional units with close business associations should be made into one micro-application, and conversely, those with less close association can be considered to be split into multiple micro-applications.
A criterion for judging whether the business is closely related: <strong>Look at whether this micro application has frequent communication needs with other micro applications</strong>. If it is possible to show that these two micro-applications are serving the same business scenario, it may be more appropriate to merge them into one micro-application.</p></div> <h3 id="loadmicroapp-app-configuration"><a href="#loadmicroapp-app-configuration" class="header-anchor">#</a> <code>loadMicroApp(app, configuration?)</code></h3> <ul><li><p>Parameters</p> <ul><li><p>app - <code>LoadableApp</code> - Required, basic information of micro application</p> <ul><li>name - <code>string</code> - Required, the name of the micro application must be unique among the micro applications.</li> <li>entry - <code>string | { scripts?: string[]; styles?: string[]; html?: string }</code> - Required, the entry address of the micro application.</li> <li>container - <code>string | HTMLElement</code> - Required, selector or Element instance of the container node of the micro application. Such as <code>container: '#root'</code> or <code>container: document.querySelector('#root')</code>.</li> <li>props - <code>object</code> - Optional, the data that needs to be passed to the micro-application during initialization.</li></ul></li> <li><p>configuration - <code>Configuration</code> - Optional, configuration information of the micro application</p> <ul><li><p>sandbox - <code>boolean</code> | <code>{ strictStyleIsolation?: boolean }</code> - Optional, whether to enable the sandbox, the default is <code>true</code>.</p> <p>When configured as <code>{strictStyleIsolation: true}</code>, it means that strict style isolation mode is enabled. In this mode, qiankun will wrap a <a href="https://developer.mozilla.org/zh-CN/docs/Web/Web_Components/Using_shadow_DOM" target="_blank" rel="noopener noreferrer">shadow dom<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> node for each micro-application container, so as to ensure that the style of the micro application will not affect the whole world.</p></li> <li><p>singular - <code>boolean | ((app: RegistrableApp&lt;any&gt;) =&gt; Promise&lt;boolean&gt;);</code> - Optional, whether it is a single instance scenario, the default is <code>false</code>.</p></li> <li><p>fetch - <code>Function</code> - Optional, custom fetch method.</p></li> <li><p>getPublicPath - <code>(url: string) =&gt; string</code> - Optional</p></li> <li><p>getTemplate - <code>(tpl: string) =&gt; string</code> - Optional</p></li></ul></li></ul></li> <li><p>返回值 - <code>MicroApp</code> - Micro application examples</p> <ul><li>mount(): Promise<null>;</null></li> <li>unmount(): Promise<null>;</null></li> <li>update(customProps: object): Promise<any>;</any></li> <li>getStatus():
| &quot;NOT_LOADED&quot;
| &quot;LOADING_SOURCE_CODE&quot;
| &quot;NOT_BOOTSTRAPPED&quot;
| &quot;BOOTSTRAPPING&quot;
| &quot;NOT_MOUNTED&quot;
| &quot;MOUNTING&quot;
| &quot;MOUNTED&quot;
| &quot;UPDATING&quot;
| &quot;UNMOUNTING&quot;
| &quot;UNLOADING&quot;
| &quot;SKIP_BECAUSE_BROKEN&quot;
| &quot;LOAD_ERROR&quot;;</li> <li>loadPromise: Promise<null>;</null></li> <li>bootstrapPromise: Promise<null>;</null></li> <li>mountPromise: Promise<null>;</null></li> <li>unmountPromise: Promise<null>;</null></li></ul></li> <li><p>Usage</p> <p>Load a micro application manually.</p> <p>If you need to support the main application to manually update the micro application, you need to export an update hook for the micro application entry:</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">mount</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">renderApp</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// Added update hook to allow the main application to manually update the micro application</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">renderPatch</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>Sample</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> loadMicroApp <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'qiankun'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  
  microApp <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  
  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>microApp <span class="token operator">=</span> <span class="token function">loadMicroApp</span><span class="token punctuation">(</span>
      <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'app1'</span><span class="token punctuation">,</span> entry<span class="token operator">:</span> <span class="token string">'//localhost:1234'</span><span class="token punctuation">,</span> container<span class="token operator">:</span> <span class="token string">'#app1'</span><span class="token punctuation">,</span> props<span class="token operator">:</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'qiankun'</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">componentWillUnmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>microApp<span class="token punctuation">.</span><span class="token function">unmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">componentDidUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>microApp<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'kuitos'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>app1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul> <h3 id="prefetchapps-apps-importentryopts"><a href="#prefetchapps-apps-importentryopts" class="header-anchor">#</a> <code>prefetchApps(apps, importEntryOpts?)</code></h3> <ul><li><p>Parameters</p> <ul><li>apps - <code>AppMetadata[]</code> - Required - list of preloaded apps</li> <li>importEntryOpts - Optional - Load configuration</li></ul></li> <li><p>Type</p> <ul><li><code>AppMetadata</code> <ul><li>name - <code>string</code> - Required - Application name</li> <li>entry - <code>string | { scripts?: string[]; styles?: string[]; html?: string }</code> - Required,The entry address of the microapp</li></ul></li></ul></li> <li><p>Usage</p> <p>Manually preload the specified micro application static resources. Only needed to manually load micro-application scenarios, you can directly configure the <code>prefetch</code> attribute based on the route automatic activation scenario.</p></li> <li><p>Sample</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> prefetchApps <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'qiankun'</span><span class="token punctuation">;</span>

<span class="token function">prefetchApps</span><span class="token punctuation">(</span><span class="token punctuation">[</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'app1'</span><span class="token punctuation">,</span> entry<span class="token operator">:</span> <span class="token string">'//locahost:7001'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'app2'</span><span class="token punctuation">,</span> entry<span class="token operator">:</span> <span class="token string">'//locahost:7002'</span> <span class="token punctuation">}</span> <span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div></li></ul> <h2 id="adderrorhandler-removeerrorhandler"><a href="#adderrorhandler-removeerrorhandler" class="header-anchor">#</a> <a href="https://single-spa.js.org/docs/api#adderrorhandler" target="_blank" rel="noopener noreferrer">addErrorHandler/removeErrorHandler<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h2> <h2 id="addglobaluncaughterrorhandler-handler"><a href="#addglobaluncaughterrorhandler-handler" class="header-anchor">#</a> <code>addGlobalUncaughtErrorHandler(handler)</code></h2> <ul><li><p>Parameters</p> <ul><li>handler - <code>(...args: any[]) =&gt; void</code> - Required</li></ul></li> <li><p>Usage</p> <p>Add the global uncaught error hander.</p></li> <li><p>Sample</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> addGlobalUncaughtErrorHandler <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'qiankun'</span><span class="token punctuation">;</span>

<span class="token function">addGlobalUncaughtErrorHandler</span><span class="token punctuation">(</span><span class="token parameter">event</span> <span class="token operator">=&gt;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li></ul> <h2 id="removeglobaluncaughterrorhandler-handler"><a href="#removeglobaluncaughterrorhandler-handler" class="header-anchor">#</a> <code>removeGlobalUncaughtErrorHandler(handler)</code></h2> <ul><li><p>Parameters</p> <ul><li>handler - <code>(...args: any[]) =&gt; void</code> - Required</li></ul></li> <li><p>Usage</p> <p>Remove the global uncaught error hander.</p></li> <li><p>Sample</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> removeGlobalUncaughtErrorHandler <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'qiankun'</span><span class="token punctuation">;</span>

<span class="token function">removeGlobalUncaughtErrorHandler</span><span class="token punctuation">(</span>handler<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li></ul> <h2 id="initgloabalstate-state"><a href="#initgloabalstate-state" class="header-anchor">#</a> <code>initGloabalState(state)</code></h2> <ul><li><p>Parameters</p> <ul><li>state - <code>Record&lt;string, any&gt;</code> - Required</li></ul></li> <li><p>Usage</p> <p>init global state, and return actions for communication. It is recommended to use in master, and slave get actions through props。</p></li> <li><p>Return</p> <ul><li><p>MicroAppStateActions</p> <ul><li><p>onGlobalStateChange: <code>(callback: OnGlobalStateChangeCallback, fireImmediately?: boolean) =&gt; void</code> - Listen the global status in the current application: when state changes will trigger callback; fireImmediately = true, will trigger callback immediately when use this method.</p></li> <li><p>setGlobalState: <code>(state: Record&lt;string, any&gt;) =&gt; boolean</code> - Set global state by first layer props, it can just modify first layer props what has defined.</p></li> <li><p>offGlobalStateChange: <code>() =&gt; boolean</code> - Remove Listener in this app, will default trigger when app unmount.</p></li></ul></li></ul></li> <li><p>Sample</p> <p>Master:</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> initGloabalState<span class="token punctuation">,</span> MicroAppStateActions <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'qiankun'</span><span class="token punctuation">;</span>

<span class="token comment">// Initialize state</span>
<span class="token keyword">const</span> actions<span class="token operator">:</span> MicroAppStateActions <span class="token operator">=</span> <span class="token function">initGloabalState</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">;</span>

actions<span class="token punctuation">.</span><span class="token function">onGlobalStateChange</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> prev</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// state: new state; prev old state</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> prev<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
actions<span class="token punctuation">.</span><span class="token function">setGlobalState</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">;</span>
actions<span class="token punctuation">.</span><span class="token function">offGlobalStateChange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Slave:</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// get actions from mount</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">mount</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

  props<span class="token punctuation">.</span><span class="token function">onGlobalStateChange</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> prev</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// state: new state; prev old state</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> prev<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  props<span class="token punctuation">.</span><span class="token function">setGlobalState</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// It will trigger when slave umount,  not necessary to use in non special cases.</span>
  props<span class="token punctuation">.</span><span class="token function">offGlobalStateChange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/umijs/qiankun/edit/master/docs/api/README.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">4/29/2020, 1:31:09 PM</span></div></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/qiankun/assets/js/app.0c03f5c9.js" defer></script><script src="/qiankun/assets/js/2.b25794af.js" defer></script><script src="/qiankun/assets/js/7.55c9405f.js" defer></script><script src="/qiankun/assets/js/3.0164b3a4.js" defer></script>
  </body>
</html>
